#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon May  3 20:19:12 2021

@author: swallan
"""
from mpmath import mpf, fabs, mp
import numpy as np
mp.dps = 25

# 4.577, 10, 10
gl_cdf =  [mpf('0.86029148101806640625'),
  mpf('0.86029136180877685546875'),
  mpf('0.8602913916110992431640625'),
  mpf('0.860291387885808944702148438'),
  mpf('0.860291387769393622875213623'),
  mpf('0.860291387871257029473781586'),
  mpf('0.860291388672521861735731363'),
  mpf('0.860291388673317669599782676'),
  mpf('0.860291388673267931608279468'),
  mpf('0.860291388673268819786699169'),
  mpf('0.860291388673268819786699169'),
  mpf('0.860291388673268778153335745'),
  mpf('0.860291388673268678406735877'),
  mpf('0.860291388673268678623576311'),
  mpf('0.860291388673268681212108998'),
  mpf('0.860291388673268681108770978'),
  mpf('0.860291388673268681109829769'),
  mpf('0.8602913886732686811098033'),
  mpf('0.8602913886732686811098033'),
  mpf('0.860291388673268681109803506')]

ts_cdf = [mpf('0.860294342041015625'),
  mpf('0.86029136180877685546875'),
  mpf('0.860291384160518646240234375'),
  mpf('0.860291377641260623931884766'),
  mpf('0.860291388584300875663757324'),
  mpf('0.860291388671612367033958435'),
  mpf('0.860291388673431356437504292'),
  mpf('0.860291388673317669599782676'),
  mpf('0.860291388673267931608279468'),
  mpf('0.860291388673267931608279468'),
  mpf('0.860291388673268708764396706'),
  mpf('0.86029138867326868100882109'),
  mpf('0.86029138867326868100882109'),
  mpf('0.860291388673268681117241308'),
  mpf('0.860291388673268681103688781'),
  mpf('0.860291388673268681109618011'),
  mpf('0.860291388673268681109829769'),
  mpf('0.860291388673268681109869474'),
  mpf('0.8602913886732686811098033'),
  mpf('0.86029138867326868110980361')]

# # 3.77, 3, 12
# gl_cdf = [mpf('0.94981479644775390625'),
#  mpf('0.94981563091278076171875'),
#  mpf('0.949817188084125518798828125'),
#  mpf('0.949817637912929058074951172'),
#  mpf('0.949817638262175023555755615'),
#  mpf('0.949817638240347150713205338'),
#  mpf('0.949817638240347150713205338'),
#  mpf('0.949817638240006090200040489'),
#  mpf('0.94981763823944476143879001'),
#  mpf('0.94981763823944387326037031'),
#  mpf('0.949817638239443651215765385'),
#  mpf('0.94981763823944362346018977'),
#  mpf('0.949817638239443475141332573'),
#  mpf('0.949817638239443475249752791'),
#  mpf('0.949817638239443475425935644'),
#  mpf('0.949817638239443475430170808'),
#  mpf('0.949817638239443475430064929'),
#  mpf('0.949817638239443475398632066'),
#  mpf('0.94981763823944347539862793'),
#  mpf('0.94981763823944347539862762')]

# ts_cdf = [mpf('0.949817657470703125'),
#  mpf('0.949817657470703125'),
#  mpf('0.94981764256954193115234375'),
#  mpf('0.949817637912929058074951172'),
#  mpf('0.949817637912929058074951172'),
#  mpf('0.949817638123931828886270523'),
#  mpf('0.949817638278545928187668324'),
#  mpf('0.949817638239437656011432409'),
#  mpf('0.94981763823944476143879001'),
#  mpf('0.94981763823944298508195061'),
#  mpf('0.94981763823944342917116046'),
#  mpf('0.949817638239443470804523884'),
#  mpf('0.949817638239443475141332573'),
#  mpf('0.949817638239443475358173008'),
#  mpf('0.949817638239443475398830589'),
#  mpf('0.949817638239443475398830589'),
#  mpf('0.949817638239443475398618831'),
#  mpf('0.949817638239443475398632066'),
#  mpf('0.949817638239443475398628757'),
#  mpf('0.949817638239443475398628551')]

gt = gl_cdf[-1]
#%%

cython = [0.8602913886801902,
 0.860291388685108,
 0.8602913886732954,
 0.8602913886732729,
 0.8602913886732719,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714,
 0.8602913886732714]

from mpmath import log10

def abs_rel_gt_log(d):
  temp = fabs(d - gt) / gt
  if (temp == mpf('0.0')):
     return 25
  return -log10(temp)

# cython_err = [fabs(c - gt) for c in cython]
# gl_err = [fabs(gl - gt) for gl in gl_cdf]
# ts_err = [fabs(ts - gt) for ts in ts_cdf]

cython_err = [abs_rel_gt_log(c) for c in cython]
gl_err = [abs_rel_gt_log(gl) for gl in gl_cdf]
ts_err = [abs_rel_gt_log(ts) for ts in ts_cdf]

rng = list(range(5, 25))

q,  k, v = 4.577, 10, 10
import matplotlib
import matplotlib.pyplot as plt
import numpy as np


plt.rc('text', usetex=True)
plt.rc('font', family='serif')
matplotlib.rcParams['figure.figsize'] = [8, 6]
matplotlib.rcParams.update({'font.size': 16})
fig, ax = plt.subplots()


ax.plot(rng,cython_err, rng, gl_err, rng, ts_err)
ax.legend(("cython", "mp-gl", "mp-ts"))
ax.set_title(f"CDF({q}, {k}, {v}) at various eps")
ax.set_ylabel("decimals of precision")
ax.set_xlabel("epsalon")
plt.xticks(range(5, 25, 1))


plt.show()












